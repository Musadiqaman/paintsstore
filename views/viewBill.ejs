<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>View Bill | <%= bill.customerName %></title>
  <link rel="icon" href="/images/weldon-paints-logo.png" type="image/png">
  <link rel="stylesheet" href="/stylesheets/printSales.css">
  <style>
    /* ===== SCREEN ONLY STYLING (Aapka UI jesa tha wesa hi rahay ga) ===== */
    .no-print-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 15px;
      background: #f8f9fa;
      border-bottom: 1px solid #ddd;
    }

    .btn {
      padding: 8px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .btn-print { background-color: #06A56C; color: white !important; }
    .btn-back { background-color: #6c757d; color: white !important; }

    .screen-wrapper {
      display: flex;
      justify-content: center;
      background-color: #e9ecef;
      min-height: 100vh;
      padding: 20px 0;
    }

    /* ===== PRINT LOGIC (Sirf Print ke waqt Navbar hatane ke liye) ===== */
    @media print {
      /* Navbar, Buttons, aur kisi bhi UI element ko zabardasti hide karna */
      nav, 
      .navbar, 
      .no-print-controls, 
      header, 
      footer:not(.footer), 
      aside {
        display: none !important;
      }

      /* Body ko print ke liye reset karna taake margin ka masla na ho */
      body {
        margin: 0 !important;
        padding: 0 !important;
      }

      .screen-wrapper {
        display: block !important;
        background: transparent !important;
        padding: 0 !important;
      }

      .print-area {
        width: 76mm !important; /* Aapki original width */
        margin: 0 !important;
        box-shadow: none !important;
      }
    }
  </style>
</head>

<body>
  <%- include('partials/navbar') %>

  <div class="no-print-controls">
    <button  class="btn btn-print">ğŸ–¨ï¸ Print Invoice</button>
    <a href="/sales/history" class="btn btn-back">ğŸ”™ Back to History</a>
  </div>

  <div class="screen-wrapper">
    <div class="print-area">
      <div class="shop-header">
        <img src="/images/weldon-paints-logo.png" id="logo">
        <div class="shop-name-en">Hamza Weldon Paint & Hardware Store</div>
        <div class="shop-name-ur">Ø­Ù…Ø²Û ÙˆÛŒÙ„ÚˆÙ† Ù¾ÛŒÙ†Ù¹ Ø§ÛŒÙ†Úˆ ÛØ§Ø±ÚˆÙˆÛŒØ¦Ø± Ø³Ù¹ÙˆØ±</div>
        <div class="shop-phones">
          <span dir="ltr">0319-9303154</span>(Ø­Ù…Ø²Û)
          <span dir="ltr">0332-9780911</span>(Ø§Ø³Ù…Ø§Ø¹ÛŒÙ„)
          <span dir="ltr">0335-0502041</span>(Ù…Ø¨Ø§Ø±Ú© Ø´Ø§Û)
        </div>
      </div>

      <br>

      <p><b>Customer Name:</b> <span style="text-transform: uppercase;"><%= bill.customerName %></span></p>
      <p><b>Agent:</b> <%= bill.agentId ? bill.agentId.name : 'Direct Sale' %></p>
      <p><b>Entry Date:</b> 
          <%= new Date(bill.createdAt).toLocaleDateString('en-GB', {timeZone: 'Asia/Karachi'}) %> | 
          <%= new Date(bill.createdAt).toLocaleTimeString('en-US', {timeZone: 'Asia/Karachi', hour:'2-digit', minute:'2-digit', hour12:true}) %>
      </p>

      <h3>Remarks:</h3>

      <table>
        <thead>
          <tr>
            <th style="width: 15%;">Stock ID</th>
            <th style="width: 15%;">Sale ID</th>
            <th style="width: 20%;">Item</th>
            <th style="width: 15%;">Color</th>
            <th style="width: 10%;">Unit</th>
            <th style="width: 5%;">Qty</th>
            <th style="width: 10%;">Price</th>
            <th style="width: 10%;">Total</th>
          </tr>
        </thead>
        <tbody>
          <% bill.salesItems.forEach(item => { %>
          <tr>
            <td><%= item.stockID %></td>
            <td><%= item.saleID || '---' %></td>
            <td><%= item.itemName %></td>
            <td><%= item.colourName %></td>
            <td><%= item.qty %></td>
            <td><%= item.quantitySold %></td>
            <td><%= item.rate.toFixed(0) %></td>
            <td><%= (item.quantitySold * item.rate).toFixed(0) %></td>
          </tr>
          <% }) %>
        </tbody>
      </table>

      <div class="footer">
        <span>Total Items: <%= bill.salesItems.length %></span>
        <span>Total Amount: Rs <%= totalAmount.toFixed(2) %></span>
      </div>

      <div class="urdu-footer">
        Ù¾ØªÛ: Ù…Ù„Ú© ØªØ§Ø¬ Ù…Ø§Ø±Ú©ÛŒÙ¹ØŒ Ø¯Ú©Ø§Ù† Ù†Ù…Ø¨Ø± 5ØŒ6 Ú©ÙˆÛØ§Ù¹ Ø¨ÙˆØ±Úˆ ÛØ§Ø¦ÛŒ ÙˆÛ’ Ú†ÙˆÚ©
      </div>

      <div class="urdu-warning">.Ø¨Ù„ Ú©Û’ Ø¨ØºÛŒØ± ÙˆØ§Ù¾Ø³ÛŒ Ù†ÛÛŒÚº ÛÙˆÚ¯ÛŒ</div>
      <div class="thank-you-section">THANK YOU FOR VISITING HAMZA PAINTS</div>

      <div class="dev-footer">
        <span>Software Developed by: M.SHOUKAT (0335 8004900)</span>
      </div>
    </div>
  </div>

<script src="/javascripts/viewBill.js"></script>  
</body>
</html>